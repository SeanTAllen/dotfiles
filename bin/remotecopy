#!/bin/bash

function putfile {
  host=$1
  user=$2
  file=$3
  dest=$4

  scpfile $host $file
  movefile $host $user "/tmp/${file}" $dest
}

function scpfile {
  host=$1
  file=$2

  echo "scp-ing $file to $host"
  scp -r -o StrictHostKeyChecking=no $file $host:/tmp
  echo "setting permissions on $file on $host"
  ssh $host chmod 666 /tmp/$file
}

function movefile {
  host=$1
  user=$2
  source=$3
  dest=$4

  echo "moving file from $source to $dest on $host"
  ssh -o StrictHostKeyChecking=no ${host} "sudo -u ${user} cp ${source} ${dest}"
  removefile $host $source
}

function removefile {
  host=$1
  file=$2

  echo "removing file $file"
  ssh -o StrictHostKeyChecking=no ${host} "rm ${file}"
}
